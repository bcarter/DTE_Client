
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html lang="EN-US">
<head>
<title>OSHA Training Institute Course Search Database</title>

<!-- 11/14/2012 -->
<!-- Site Specific -->
<meta name="Agency" content="OSHA">
<meta name="Subagency" content="NONE">
<meta name="Doctype" content="HTML">
<meta name="Subject" content="Workplace Safety & Health">
<meta name="MSSmartTagsPreventParsing" content="TRUE">
<meta http-equiv="pragma" content="no-cache">
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">

<!-- Page Specific -->
<meta name="Audience" content="GENERAL">
<meta name="keywords" content="OSHA Training Institute Course Search Database">
<meta name="Description" content="OSHA Training Institute Course Search Database">
<meta name="Date" content="10/24/2012">
<meta name="Contentowner" content="OSHA-Directorate of Training and Education">
<meta name="Robots" content="index,follow">
<meta name="Expdate" content="none">

<link rel="stylesheet" type="text/css" href="/styles/intratemplate.css" />
<link rel="stylesheet" href="/styles/variable-textomds.css">
<script language="javascript" src="/jscripts/date.js"></script>



<!-- Begin Additional Code for HEAD tag -->
<!-- Last Updated by KD - 010/24/2012 - fixed js error and added onload -->
<!-- Last Updated by KD - 02/27/2012 - Added instructions for registration link -->
<!-- Last Updated by KD - 02/27/2012 - DTE updates per conference call -->
<!-- Last Updated by KD - 02/22/2012 - Created page -->
<style>

        /* tab styles */
    #tabrow {
        margin:0;
        padding-left:1ex;
        padding-right:1ex;
        max-width: 990px;
        line-height:1.2;
        height:28px;
    }

    #tabrow ul {
        margin: 0px 0px 0px 500px;
        padding:0px;
        list-style:none;
        position:absolute;
        z-index:2;
    }

    #tabrow li {
        float:left;
        background-color:#F3F3F3;
        height:16px;
        margin-right:5px;
        padding:5px 5px 5px 5px;
        -webkit-border-top-left-radius:5px;
        -webkit-border-top-right-radius:5px;
        -moz-border-radius-topleft:5px;
        -moz-border-radius-topright:5px;
        border-top:solid #D9D9D9 2px;
        border-left:solid #D9D9D9 2px;
        border-right:solid #D9D9D9 2px;
        border-bottom-width:0;
        border-bottom-color:transparent;
        cursor:pointer;
    }

    *html #tabrow li {
        padding:4px 5px 2px 5px;
        height:28px;
    }

    #tabrow li.select {
        background-color:#FFFFFF;
        height:18px;

    }

    *html  #tabrow li.select {
        background-color:#FFFFFF;
        height:30px;
        padding:4px 5px 7px 5px;
    }

        /* page styles */

    #topbox, #midbox {
        width:100%;
        -webkit-border-radius: 20px;
        -moz-border-radius: 20px;
    }

    #topbox {
        background-color:#FFFFFF;
        border: solid #D9D9D9 1px;
        margin-bottom:2em;
    }

    #midbox {
        border: solid #D9D9D9 2px;
        background-color:#FFFFFF;
    }

    #midbox p {
        margin:0;
        padding-bottom:1ex;
    }
    div.subpage {
        padding:1em;

    }
</style>

<script type="text/JavaScript" src="curvycorners.src.js"></script>

<script type="text/JavaScript">
    curvyCorners.addEvent(window, 'load', initCorners);
    function initCorners() {
        var settings = {
            tl: { radius: 20 },
            tr: { radius: 20 },
            bl: { radius: 20 },
            br: { radius: 20 },
            antiAlias: true
        }

        curvyCorners(settings, ",");
    }

    //<![CDATA[

    var selectedTab = 0;
    function tabclick(n) {
        if (n === selectedTab) return; // nothing to do.
        var li = document.getElementById('tab' + selectedTab);
        curvyCorners.adjust(li, 'className', ''); // Remove the 'select' style
        li = document.getElementById('page' + selectedTab);
        li.style.display = 'none';                // hide the currently selected sub-page
        li = document.getElementById('page' + n);
        li.style.display = 'block';               // show the new sub-page
        li = document.getElementById('tab' + n);  // get the new (clicked) tab
        curvyCorners.adjust(li, 'className', 'select'); // and update its style
        curvyCorners.redraw();        // Redraw all elements with className curvyRedraw
        selectedTab = n;              // store for future reference
    }

    //]]>

    function ReverseDisplay(application) {
        if(document.getElementById(application).style.display == "none") {
            document.getElementById(application).style.display = "block";
            curvyCorners.handleWinResize();
        }
        else {
            document.getElementById(application).style.display = "none";
            curvyCorners.handleWinResize();
        }

    }
</script>



<script type="text/javascript">



    //This function is used to retrive external XML for AJAX type functionality.
    //The XML loaded from the url parameter will be passed back to the calling function as an XML object.
    //Usage: var testXML = getXML("someXMLURL.gov");
    function getXML(url){
        var xmlDoc;
        var ajaxRequest;  // The variable that makes Ajax possible!

        try{
            // Opera 8.0+, Firefox, Safari
            ajaxRequest = new XMLHttpRequest();
        } catch (e){
            // Internet Explorer Browsers
            try{
                ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
            } catch (e) {
                try{
                    ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
                } catch (e){
                    // Something went wrong
                    alert("Your browser broke!");
                    return false;
                }
            }
        }


        // Create a function that will receive data sent from the server
        ajaxRequest.onreadystatechange = function(){
            if(ajaxRequest.readyState == 4){
                xmlDoc = ajaxRequest.responseText;
            }
        }
        ajaxRequest.open("GET", url, false);
        ajaxRequest.send(null);

        xmlDoc = ajaxRequest.responseXML.documentElement;
        return xmlDoc;
    }





    //This function is used to add JavaScript function calls to the onLoad stack.
    //Multiple calls to onLoad= sometimes has unexpected results, this function
    //  simply adds the calls to the existing stack so all are executed.
    //Usage: addOnLoad(alert("Hello World!"));
    function addOnLoad(func) {
        var curOnLoad = window.onload;
        if (typeof window.onload != 'function') {
            window.onload = func;
        } else {
            window.onload = function() {
                if (curOnLoad) {
                    curOnLoad();
                }
                //try catch added to ignore bogus IE error.
                try{func();} catch (err) {}
            }
        }
    }

</script>



<script type="text/javascript">

var urlPath = "/pls/dtecourses/";
//var urlPath = "/pls/dte/";
var userType = "A", userLoc;
var userType, userLoc;

// call the js function to load when page is called
addOnLoad(getUserAccess);
addOnLoad(makeStateLov);
addOnLoad(makeTitleLov);
addOnLoad(makeLangLov);
addOnLoad(getCourse);
addOnLoad(makeCenterLov);
//addOnLoad(makeLengthLov);



// function to determine what access the user has
function getUserAccess(){
    var accessCode;
    var xmlDoc, retVal = "ok";
    var adminElement;

    xmlDoc = getXML(urlPath+"dte_courses.get_user_access");
    retVal=xmlDoc.getElementsByTagName("return")[0].childNodes[0].nodeValue;

    if (retVal != "success"){
        userType = "A";   // only User access
        userLoc = 900;        // not associated to Ed Center
    } else {
        userType = xmlDoc.getElementsByTagName("type")[0].childNodes[0].nodeValue;
        userLoc = xmlDoc.getElementsByTagName("location")[0].childNodes[0].nodeValue;
    }
    if ( userType != "S" ) {
        adminElement = document.getElementById("page3");
        adminElement.style.display = "none";
        adminElement.innerHTML = "Administrator Access Required for this page.";
    }
}



// function to load an initial data record for edit if called from the search screen
function getCourse(){
    var vId = getParam("p_course_id");
    var indVal, xmlDoc, retVal = "ok";
    var centerId, centerDesc, centerE;

    if (vId == "") return;

    xmlDoc = getXML(urlPath + "dte_courses.get_course?p_course_id=" + vId);
    retVal=xmlDoc.getElementsByTagName("return")[0].childNodes[0].nodeValue;
    if (retVal != "ok"){
        alert(retVal);
    } else {
        // get the values from the database for this record
        centerId = xmlDoc.getElementsByTagName("center_id")[0].childNodes[0].nodeValue;
        centerDesc = xmlDoc.getElementsByTagName("center")[0].childNodes[0].nodeValue;
        indVal = xmlDoc.getElementsByTagName("industry")[0].childNodes[0].nodeValue;
        sDate = xmlDoc.getElementsByTagName("start")[0].childNodes[0].nodeValue;
        eDate = xmlDoc.getElementsByTagName("end")[0].childNodes[0].nodeValue;
        title = xmlDoc.getElementsByTagName("title")[0].childNodes[0].nodeValue;
        titleDesc = xmlDoc.getElementsByTagName("title_desc")[0].childNodes[0].nodeValue;
        crsloc = xmlDoc.getElementsByTagName("loc")[0].childNodes[0].nodeValue;
        len = xmlDoc.getElementsByTagName("length")[0].childNodes[0].nodeValue;
        noDays = xmlDoc.getElementsByTagName("numdays")[0].childNodes[0].nodeValue;
        address = xmlDoc.getElementsByTagName("address")[0].childNodes[0].nodeValue;
        city = xmlDoc.getElementsByTagName("city")[0].childNodes[0].nodeValue;
        lang = xmlDoc.getElementsByTagName("lang")[0].childNodes[0].nodeValue;
        state = xmlDoc.getElementsByTagName("state")[0].childNodes[0].nodeValue;
        crscost = xmlDoc.getElementsByTagName("cost")[0].childNodes[0].nodeValue;
        crsurl = xmlDoc.getElementsByTagName("url")[0].childNodes[0].nodeValue;
        crscm = xmlDoc.getElementsByTagName("cm")[0].childNodes[0].nodeValue;
        crsceu = xmlDoc.getElementsByTagName("ceu")[0].childNodes[0].nodeValue;


        // now render the screen elements accordingly
        centerE = document.getElementById("select3");
        titleE = document.getElementById("Title");
        langE = document.getElementById("select2");
        stateE = document.getElementById("select4");

        for ( var i=0; i<centerE.options.length; i++){
            if ( centerE.options[i].text == centerDesc ) { centerE.options[i].selected = true; }
        }

        for ( var i=0; i < langE.options.length; i++){
            if ( langE.options[i].text == lang ) { langE.options[i].selected = true; }
        }

        for ( var i=0; i < titleE.options.length; i++){
            if ( titleE.options[i].text == title ) { titleE.options[i].selected = true; }
        }

        for ( var i=0; i < stateE.options.length; i++){
            if ( stateE.options[i].text == state ) { stateE.options[i].selected = true; }
        }

        if (indVal == 1) {
            document.getElementById("gen").checked = true;
        } else if (indVal == 2) {
            document.getElementById("con").checked = true;
        } else if (indVal == 3) {
            document.getElementById("mar").checked = true;
        }

        document.getElementById("startDate").value = sDate;
        document.getElementById("endDate").value = eDate;


        document.getElementById("titleDesc").value = titleDesc;
        document.getElementById("textfield4").value = crsloc;
        document.getElementById("courseLength").value = len;
        document.getElementById("noOfDays").value = noDays;
        document.getElementById("textfield").value = address;
        document.getElementById("textfield2").value = city;
        document.getElementById("cost").value = crscost;
        document.getElementById("url").value = crsurl;
        document.getElementById("cmPoints").value = crscm;
        document.getElementById("ceuPoints").value = crsceu;
        // set a hidden element in the document with the value of the course id
        document.getElementById("crsId").value = vId;

    }

}

// function to retrieve the parameters passed to the page.  name is parameter your looking for.  Returns value of the parameter.
function getParam( name ){
    name = name.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
    var regexS = "[\\?&]"+name+"=([^&#]*)";
    var regex = new RegExp( regexS );
    var results = regex.exec( window.location.href );
    if( results == null )
        return "";
    else
        return results[1];
}


// function called when document submit button is clicked.
function submitDocument(){
    var indVal, xmlDoc, courseId, retVal = "ok";

    try {
        courseId = document.getElementById("crsId").value;
        noDays = document.getElementById("select").value;
        cmPts = document.getElementById("cmPoints").value;
        ceuPts = document.getElementById("ceuPoints").value;
        cst = document.getElementById("cost").value;

        ////// check required field entry /////
        if ( document.getElementById("textfield4").value.length == 0 ) {
            document.getElementById("textfield4").focus();
            throw new Error("Req");
        }

        if ( document.getElementById("textfield").value.length == 0 ) {
            document.getElementById("textfield").focus();
            throw new Error("Req");
        }

        if ( document.getElementById("textfield2").value.length == 0 ) {
            document.getElementById("textfield2").focus();
            throw new Error("Req");
        }

        if ( document.getElementById("url").value.length == 0 ) {
            document.getElementById("url").focus();
            throw new Error("Req");
        }

        if ( document.getElementById("startDate").value == "mm/dd/yyyy" ) {
            document.getElementById("startDate").focus();
            throw new Error("Req");
        }

        if ( document.getElementById("endDate").value == "mm/dd/yyyy" ) {
            document.getElementById("endDate").focus();
            throw new Error("Req");
        }

        if ( document.getElementById("courseLength").value.length == 0 ) {
            document.getElementById("courseLength").focus();
            throw new Error("Req");
        }

        ////// set optional field entry if null /////

        if( courseId.length == 0 ) {
            courseId = "";
        }

        if ( noDays.length == 0 ) {
            noDays = 0;
        }

        if ( cmPts.length == 0 ) {
            cmPts = 0;
        }

        if ( ceuPts.length == 0 ) {
            ceuPts = 0;
        }

        if ( cst.length == 0 ) {
            cst = "";
        }

        xmlDoc = getXML(urlPath + "dte_courses.add_oti_course?p_center_id=" + document.getElementById("select3").value +
                "&p_title_id=" + document.getElementById("crsTitle").value +
//             "&p_industry_id=" + indVal + 
                "&p_length=" + document.getElementById("courseLength").value +
                "&p_num_days=" + noDays +
                "&p_lang_id=" + document.getElementById("select2").value +
                "&p_city=" + encodeURIComponent(document.getElementById("textfield2").value) +
                "&p_state_id=" + document.getElementById("select4").value +
                "&p_location=" + encodeURIComponent(document.getElementById("textfield4").value) +
                "&p_address=" + encodeURIComponent(document.getElementById("textfield").value) +
                "&p_url=" + encodeURIComponent(document.getElementById("url").value) +
                "&p_start_date="+ document.getElementById("startDate").value + "&p_end_date="+ document.getElementById("endDate").value +
                "&p_cost=" + cst +
                "&p_cm_points=" + cmPts +
                "&p_ceu_points=" + ceuPts +
                "&p_course_id=" + courseId );

        retVal=xmlDoc.getElementsByTagName("return")[0].childNodes[0].nodeValue;

        if (retVal != "success"){
            alert(retVal);
        } else {
            alert("Course Saved");
        }
    } catch(e){
        if ( e.name.toString() == "TypeError" ) {
            alert("Your extranet connection has expired.  you must login to continue.");
            window.location.reload();
        } else if ( e.name.toString() == "Error" ){
            alert("A required field has not been populated.  Please complete the course entry.");
        } else {
            alert("The extranet connection may have expired.  Please try this operation again. ");
            window.location.reload();
        }
    }
}

// function to clear entry fields upon request from user  
function clearDocument(p_pgNo) {
    try {
        if (p_pgNo == 1) {
            document.getElementById("select3").value = 0;
            document.getElementById("crsTitle").value = 0;
            document.getElementById("titleDesc").value = "";
            document.getElementById("courseLength").value = "";
            document.getElementById("select").value = "";
            document.getElementById("select2").value = 1;
            document.getElementById("textfield2").value = "";
            document.getElementById("select4").value = 0;
            document.getElementById("textfield4").value = "";
            document.getElementById("textfield").value = "";
            document.getElementById("url").value = "";
            document.getElementById("cost").value = "";
            document.getElementById("startDate").value = "mm/dd/yyyy";
            document.getElementById("endDate").value = "mm/dd/yyyy";
            document.getElementById("cmPoints").value = "";
            document.getElementById("ceuPoints").value = "";
        }

        if (p_pgNo == 3) {
            document.getElementById("pg3Title").value = 0;
            document.getElementById("stateLov").value = 0;
            document.getElementById("pg3EdCenter").value = 0;
            document.getElementById("noOfDays").value = "";
            document.getElementById("pg3startDate").value = "01/01/2011";
            document.getElementById("pg3endDate").value = "12/31/2013";
            document.getElementById("pg3cmPoints").checked = "";
            document.getElementById("pg3ceuPoints").checked = "";
        }
    } catch(e) {
        window.location.reload();
    }
}



function getDesc(selectObj) {
//   var id = selectObj.selectedIndex;
    var id = selectObj.value;
    var xmlDoc, text;
    if ( id != 0 ) {
        xmlDoc = getXML(urlPath+"dte_courses.get_description?p_id="+id);
        text=xmlDoc.getElementsByTagName("return")[0].childNodes[0].nodeValue;
        if(text != "error") {
            desc = xmlDoc.getElementsByTagName("description")[0].childNodes[0].nodeValue;
        }
    } else { desc = ""; }
    selItem = document.getElementById('titleDesc');
    selItem.value = desc;
}


function makeCenterLov(){
    var xmlDoc, text;
    xmlDoc = getXML(urlPath + "dte_courses.get_ed_center_lov");
    text=xmlDoc.getElementsByTagName("return")[0].childNodes[0].nodeValue;

    if(text != "error"){
        selItem = document.getElementById('select3');
        selItem2 = document.getElementById('pg3EdCenter');
        centers = xmlDoc.getElementsByTagName("center");
        selItem4 = document.getElementById('pg4EdCenter');
        var newOpt;// = new Option(" ","0");

        // if the user is not an admin user, we want to build the LOV to include all values and complete list
        // otherwise we only want to allow admin users to see courses associated to their ed center.
        if ( userType == "S" ) {
            var newOpt2 = new Option("All","0");
            selItem2[0] = newOpt2;
        }

        for(i=0; i < centers.length; i++){
            newItem = centers[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;
            newVal = centers[i].getElementsByTagName("id")[0].childNodes[0].nodeValue;
            var newOpt = new Option(newItem,newVal);
            var newOpt2 = new Option(newItem,newVal);
            var newOpt4 = new Option(newItem,newVal);

            if ( userType == "A" ) {
                if ( centers[i].getElementsByTagName("id")[0].childNodes[0].nodeValue == userLoc ) {
                    selItem[0] = newOpt;
                    selItem2[0] = newOpt2;
                }
            } else {
                selItem[i] = newOpt;
                selItem2[i+1] = newOpt2;
                selItem4[i] = newOpt4;
            }
        }
    }
}



function makeTitleLov(){
    var xmlDoc, text;
    xmlDoc = getXML(urlPath + "dte_courses.get_title_lov");
    text=xmlDoc.getElementsByTagName("return")[0].childNodes[0].nodeValue;

    if(text != "error"){
        selItem = document.getElementById('crsTitle');
        selItem3 = document.getElementById('pg3Title');
        var newOpt = new Option("All","0");
        selItem3[0] = newOpt;
        newOpt = new Option("","0");
        selItem[0] = newOpt;
        title = xmlDoc.getElementsByTagName("title");

        for(i=0; i < title.length; i++){
            newItem = title[i].getElementsByTagName("name")[0].childNodes[0].nodeValue;
            newVal = title[i].getElementsByTagName("id")[0].childNodes[0].nodeValue;
            newOpt = new Option(newItem,newVal);
            selItem[i+1] = newOpt;
            newOpt = new Option(newItem,newVal);
            selItem3[i+1] = newOpt;
        }
    }
}




function makeLangLov(){
    var xmlDoc, text;
    xmlDoc = getXML(urlPath + "dte_courses.get_lang_lov");
    text=xmlDoc.getElementsByTagName("return")[0].childNodes[0].nodeValue;
    if(text != "error"){
        selItem = document.getElementById('select2');
        lang = xmlDoc.getElementsByTagName("language");

        for(i=0; i < lang.length; i++){
            newItem = lang[i].getElementsByTagName("lang")[0].childNodes[0].nodeValue;
            newVal = lang[i].getElementsByTagName("id")[0].childNodes[0].nodeValue;
            var newOpt = new Option(newItem,newVal);
            selItem[i] = newOpt;
//			alert(newItem + " " + newVal);
        }
    }
}




function makeStateLov(){
    var xmlDoc, text;
    xmlDoc = getXML(urlPath + "dte_courses.get_state_lov");
    text=xmlDoc.getElementsByTagName("return")[0].childNodes[0].nodeValue;

    if(text != "error"){
        selItem = document.getElementById('stateLov');
        selItem4 = document.getElementById('select4');
        state = xmlDoc.getElementsByTagName("state");
        var newOpt = new Option("All","0");
        selItem[0] = newOpt;
        for(i=0; i < state.length; i++){
            newItem = state[i].getElementsByTagName("desc")[0].childNodes[0].nodeValue;
            newVal = state[i].getElementsByTagName("id")[0].childNodes[0].nodeValue;
            newOpt = new Option(newItem,newVal);
            selItem[i+1] = newOpt;
            newOpt = new Option(newItem,newVal);
            selItem4[i] = newOpt;
        }
    }
}





function makeLengthLov(){
    var xmlDoc, text;
    xmlDoc = getXML(urlPath + "dte_courses.get_length_lov");
    text=xmlDoc.getElementsByTagName("return")[0].childNodes[0].nodeValue;
    if(text != "error"){
        selItem = document.getElementById('select');
        lgth = xmlDoc.getElementsByTagName("length");
        for(i=0; i < lgth.length; i++){
            newItem = lgth[i].getElementsByTagName("desc")[0].childNodes[0].nodeValue;
            newVal = lgth[i].getElementsByTagName("id")[0].childNodes[0].nodeValue;
            var newOpt = new Option(newItem,newVal);
            selItem[i] = newOpt;
//			alert(newItem + " " + newVal);
        }
    }
}

// function called when document search button is clicked.

function courseSearch(pageNo){
    var indVal, xmlDoc, retVal = "ok";
    var temp;
    var dataString;
    var dataGrid, edCenter, title, sDate, eDate, state, numDays;
    var cmPts, ceuPts;
    var userEditable, approval;

    try {
        if (document.getElementById("pg3cmPoints").checked) {
            cmPts = "Y";
        } else {
            cmPts = "N";
        }

        if (document.getElementById("pg3ceuPoints").checked) {
            ceuPts = "Y";
        } else {
            ceuPts = "N";
        }

        if ( pageNo == 1 ){
            dataGrid = document.getElementById("dgrid");
            edCenter = document.getElementById("edCenter").value;
            title = "";
            sDate = "";
            eDate = "";
            state = "";
            numDays = "";
            approval = "N";
        } else if ( pageNo == 3 ) {
            dataGrid = document.getElementById("pg3dgrid");
            edCenter = document.getElementById("pg3EdCenter").value;
            title = document.getElementById("pg3Title").value;
            sDate = document.getElementById("pg3StartDate").value;
            eDate = document.getElementById("pg3EndDate").value;
            state = document.getElementById("stateLov").value;
            numDays = document.getElementById("noOfDays").value;
            approval = "N";
        }

        temp = document.getElementById("stateLov").value;


        xmlDoc = getXML(urlPath + "dte_courses.get_courses?p_ed_cntr_id=" + edCenter +
                "&p_crs_title_id=" + title +
                "&p_start_date=" + sDate +
                "&p_end_date=" + eDate +
                "&p_state_id=" + state +
                "&p_num_days=" + numDays +
                "&p_cm_points="+ cmPts +
                "&p_ceu_points="+ ceuPts +
                "&p_need_apprv=" + approval);
//             "&p_lang_id=" + document.getElementById("select2").value );

        retVal=xmlDoc.getElementsByTagName("return")[0].childNodes[0].nodeValue;
        if (retVal != "ok"){
            alert(retVal);
        } else {
            var tabId = "pg"+pageNo+"Data";  // create and id for the datagrid for each page
            dataString ='<table width="960" border="0" summary="" id=' + tabId + '>';
//       dataString = dataString + '<tr style="font-size:70%; font-weight:bold; background:#D9D9D9;"> <td width="145">Education Center</td><td width="175">Course Title</td><td width="70">Start Date</td><td width="70">End Date</td><td width="110">Training Location</td><td width="120">Address</td><td width="80">City</td><td width="40">State</td><td width="40">CM</td><td width="40">CEU</td> <td width="40"></td><td width="30"></td></tr>';

            courses = xmlDoc.getElementsByTagName("course");

            for(i=0; i < courses.length; i++){
                var tabId = courses[i].getElementsByTagName("courseId")[0].childNodes[0].nodeValue;
                var colorStr;
                var vFeatures = '"dialogWidth:1100px"';

                if ( i % 2 == 0){
                    backgroundStr = "background:#FFFFFF;"
                } else {
                    backgroundStr = "background:#F3F3F3;"
                }

                userEditable = '</td><td width="40" align="center" valign="top"><a target="_blank" href="course_input_screen.html?p_course_id='+courses[i].getElementsByTagName("courseId")[0].childNodes[0].nodeValue+'" title="Edit"> <img src="box_edit.png" alt="Edit" title="Edit" border="0"/></a>' +
                        '</td><td width="30" align="center" valign="top"><img src="box_delete.png" alt="Delete" title="Delete" border="0" onclick="deleteRow(' + courses[i].getElementsByTagName("courseId")[0].childNodes[0].nodeValue + ')"/>';

                dataString = dataString + '<tr style="font-size:70%; '+ backgroundStr + '" ondblclick=window.showModalDialog("course_input_screen.html?p_course_id=' + courses[i].getElementsByTagName("courseId")[0].childNodes[0].nodeValue + '","",' + vFeatures + ');> <td width="140" valign="top"> ' + courses[i].getElementsByTagName("ed_center")[0].childNodes[0].nodeValue +
                        '</td><td id="crsId' + i + '"width="0" valign="top" style="display:none">'+ courses[i].getElementsByTagName("courseId")[0].childNodes[0].nodeValue +
                        '</td><td width="175" valign="top">'+ courses[i].getElementsByTagName("title")[0].childNodes[0].nodeValue +
                        '</td><td width="70"valign="top">'+ courses[i].getElementsByTagName("start")[0].childNodes[0].nodeValue +
                        '</td><td width="70" valign="top">'+ courses[i].getElementsByTagName("end")[0].childNodes[0].nodeValue +
                        '</td><td width="110" valign="top">'+ courses[i].getElementsByTagName("location")[0].childNodes[0].nodeValue +
                        '</td><td width="120" valign="top">'+ courses[i].getElementsByTagName("address")[0].childNodes[0].nodeValue +
                        '</td><td width="80" valign="top">'+ courses[i].getElementsByTagName("city")[0].childNodes[0].nodeValue +
                        '</td><td width="40" align="center" valign="top">'+ courses[i].getElementsByTagName("state")[0].childNodes[0].nodeValue +
                        '</td><td width="40" align="center" valign="top">'+ courses[i].getElementsByTagName("cmpoints")[0].childNodes[0].nodeValue +
                        '</td><td width="40" align="center" valign="top">'+ courses[i].getElementsByTagName("ceupoints")[0].childNodes[0].nodeValue +
                        userEditable +
                        '</td> </tr>';
            }
            dataGrid.innerHTML = dataString;
        }
    } catch(e) {
        window.location.reload();
    }
}



function deleteRow(courseId) {
    var xmlDoc, text;
    if (confirm("Delete the Row?")){
        xmlDoc = getXML(urlPath + "dte_courses.delete_course?p_course_id=" + courseId );
        text=xmlDoc.getElementsByTagName("return")[0].childNodes[0].nodeValue;
        if(text != "error"){
            alert("Record Deleted");
        } else {
            alert("Deletion Failed");
        }
    }
}


function addUser() {
    var email  = document.getElementById("userEmail").value;
    var center = document.getElementById("pg4EdCenter").value;
    var admin = "A"; // user functionality removed per Jim.  All extranet users are created as Admin Users.
    var xmlDoc, text;

    try {
        alert("submit user: " + email);
        xmlDoc = getXML( urlPath + "dte_courses.add_user?p_email=" + email + "&p_ed_center_id=" + center + "&p_user_type=" + admin );
        text=xmlDoc.getElementsByTagName("return")[0].childNodes[0].nodeValue;

        if(text == "success"){
            alert("OTIEC User Submitted.");
        } else {
            alert("User Submission Failed.");
        }
    } catch(e) {
        window.location.reload();
    }
}

</script>




<link rel="stylesheet" href="https://www.osha.gov/dte/dte.css">
<!-- End Additional Code for HEAD tag -->
<!--START SSI For Intranet Header--></head>
<body>
<div align="center">
<div id="container">
<div id="header">
<table summary="" width="100%" cellpadding="0" cellspacing="0">
    <tr>
        <td>
            <div id="dollogo"><a href="http://www.dol.gov" title="Department of Labor - Home">U.S. DEPARTMENT OF LABOR</a></div>
            <div><a href="/" title="OSHA IntraNet Logo"><img src="/images/intranetlogo.png" alt="OSHA Intranet Logo" border="0"></a></div>
        </td>
        <td align="right">
            <div id="toplinks"><a class="red" href="http://www.labornet.dol.gov/" title="LaborNet">LaborNet</a>  |  <a class="red" href="http://www.dol.gov/" title="DOL.gov">DOL.gov</a>  |  <a href="http://www.osha.gov" title="OSHA Public Site">OSHA.gov</a>  |  <a href="/directory.html" title="Employee Directory">OSHA Directory</a>  |  <a href="/new-a-z-index.html" title="A to Z Index">A to Z Index</a>  |  <a href="/helpdesk/index.html" title="IT Helpdesk">IT Helpdesk</a>  |  <a href="http://extranet.osha.gov/remote/logout.html" title="EXTRANET Log Out">EXTRANET Log Out</a></div>
            <div id="search"><form action="/pls/oshainternal/intranet.search_results" method="GET"><input type="text" size="60" name="p_text"> <input  type="submit" value="Find" class="submit"></form>
            </div>
        </td>
    </tr>
</table>
<div id="bluenav" align="center">
    <a href="/" title=""><img src="/images/bluebar_home.png" alt="Home" border="0"></a><a href="/employeeresources.html" title="Employee Resources"><img src="/images/bluebar_employeeresources.png" alt="Employee Resources" border="0"></a><a href="/workplaceresources.html" title="Workplace Resources"><img src="/images/bluebar_workplaceresources.png" alt="Workplace Resources" border="0"></a><a href="/nationaloffice.html" title="National Office links"><img src="/images/bluebar_nationaloffice.png" alt="National Office" border="0"></a><a href="/regionaloffices.html" title="Regional Offices"><img src="/images/bluebar_regionaloffices.png" alt="Regional Offices" border="0"></a><a href="/stateoffices.html" title="State Offices"><img src="/images/bluebar_stateoffices.png" alt="State Offices" border="0"></a><a href="http://www.osha.gov" title="OSHA Public Site"><img src="/images/bluebar_oshapublicsite.png" alt="OSHA Public Site" border="0"></a>
</div>
<div id="maincontent" style="position:relative; top:5px;">
<table cellspacing="0" cellpadding="0" summary="" width="100%">
<tr>
<td valign="top" id="pagecontent"><!--END SSI For Intranet Header-->
<!-- START BODY -->
<table width="100%" cellspacing="0" cellpadding="0" summary="">
<tr>
<td valign="top" > <a name="course"></a>
<div id="tabrow">
    <ul>
        <li id="tab0" onClick="tabclick(0);" class="select curvyRedraw"><strong>Home</strong></li>
        <li id="tab1" onClick="tabclick(1);" class="curvyRedraw"><strong>Course
            Input</strong></li>
        <li id="tab2" onClick="tabclick(2);" class="curvyRedraw"><strong>Course
            Edit</strong></li>
        <li id="tab3" onClick="tabclick(3);" class="curvyRedraw"><strong>User
            Admin</strong></li>
    </ul>
</div>

<div id="midbox" class="curvyRedraw">

<div id="page0" class="subpage" style="height:525px;">
    <div align="center"><img src="banner.png" border="0" alt="OTI Education Center Course Search"></div>
    <br>

    <p class="blackTen">Welcome to the OSHA Training Institute (OTI) Education Centers online Extranet Access page.  This application allows authorized OTI Education Center designees to add, update, or delete OTI numbered courses contained in the searchable course schedule for the general public on the OSHA website. <br>
        <br>
        The course content available for entry on this site includes the following:  course title, description, training location, address including city and state, the start/end dates, number of training days, total contact hours, CM points, CEU points, cost, language, and a registration URL.
    </p>
    <ul>
        <li><a href="#" onClick="tabclick(1);" title="Course Input Screen">Course
            Input Screen</a> - Use this screen to add new courses. </li>
        <li><a href="#" onClick="tabclick(2);" title="Course Edit Screen">Course
            Edit Screen</a> - Use this screen to edit or delete courses. </li>
        <li><a href="#" onClick="tabclick(3);" title="Admin Screen">Admin
            Screen</a> - For OSHA use only. </li>
    </ul>
          <span class="blackTen"><strong>NOTE:</strong> Do <strong>NOT</strong> 
          include the following among your course entries:</span>
    <ul>
        <li>Out-of-Region training; </li>
        <li>Out-of-jurisdiction training; </li>
        <li>Online training; </li>
        <li>Outreach training (10- or 30-hour classes); </li>
        <li>or Any other non-OTIEC training.</li>
    </ul>

    <p class="blackTen"><strong>Attention:</strong> You will only be allowed to view and edit course entries once you have been approved as a designated OTI Education Center Administrator by the system administrator.   If you are unable to access your OTI Education Centers’ course data, please email <a href="mailto:Xanos.Steve@dol.gov" title="Xanos.Steve@dol.gov">Xanos.Steve@dol.gov</a> and include your email address, the name of your lead OTI Education Center (if applicable), and your organization name.
    </p>

</div>


<div id="page1" class="subpage" style="display:none; height:600px;">
    <div align="center"><img src="banner.png" border="0" alt="OTI Education Center Course Search"></div>
    <p><h2>Sponsoring OTI Education Center: <select id="select3" name="select3" class="frmFieldSearch"></select></h2></p>
    <div style="border: 2px solid D9D9D9; padding: 2px;">
        <h2 style="background-color:#D9D9D9; padding: 2px;">Course Input</h2>
        <input  type= "hidden" id="crsId" />
        <table width="970" border="0" cellspacing="0" cellpadding="0" summary="">
            <tr>
                <td valign="top" width="75%">
                    <table width="100%" border="0" cellspacing="0" cellpadding="2" summary="">
                        <tr valign="top" >
                            <td><span class="blackTen"><strong>Title:</strong>*</span></td>
                            <td class="blackTen"> <select id="crsTitle" name="crsTitle" class="frmFieldSearch" onChange="getDesc(this);"></select> </td>
                        </tr>
                        <tr valign="top" >
                            <td class="blackTen"><strong>Description:</strong></td>
                            <td ><textarea id="titleDesc" name="titleDesc" cols="92" rows="7" readonly class="blackSix" style="background-color:#F3F3F3;"></textarea></td>
                        </tr>
                        <tr valign="top" >
                            <td colspan="2" class="blackTen"></td>
                        </tr>
                        <tr valign="top" >
                            <td width="7%" class="blackTen"><strong>Location:</strong>* </td>
                            <td class="blackTen"> <input id="textfield4" name="textfield4" type="text" size="92"></td>
                        </tr>
                        <tr valign="top" >
                            <td class="blackTen"><strong>Address:</strong>*</td>
                            <td class="blackTen"> <input id="textfield" name="textfield" type="text" size="92"></td>
                        </tr>
                        <tr>
                            <td valign="middle" class="blackTen"><strong>City:</strong>*</td>
                            <td valign="top"  class="blackTen"> <input name="textfield2" id="textfield2" type="text" size="70"> <strong> </strong></td>
                        </tr>
                        <tr valign="top" >
                            <td class="blackTen"><strong>State: </strong>*</td>
                            <td class="blackTen"><strong><select id="select4" name="select4" class="frmFieldSearch"></select></strong></td>
                        </tr>
                        <tr valign="top" >
                            <td colspan="2"><span class="blackTen"><strong>Registration
                                Link:</strong>*</span> <span class="blackSix">[Website
                        links only. Please ensure link includes &quot;http://&quot;.]</span>
                                <input id="url" name="url" type="text" size="106"></td>
                        </tr>
                    </table>
                </td>
                <td width="25%" valign="top">
                    <table width="100%" border="0" cellspacing="0" cellpadding="2" summary="" class="blackTen">
                        <tr valign="top" >
                            <td width="48%" ><strong>Start Date:</strong>*</td>
                            <td width="52%" ><input id="startDate" name="startDate" type="text" size="10" value="mm/dd/yyyy"></td>
                        </tr>
                        <tr valign="top" >
                            <td ><strong>End Date:</strong>*</td>
                            <td width="52%"><input id="endDate" name="endDate" type="text" size="10" value="mm/dd/yyyy"></td>
                        </tr>
                        <tr valign="top" >
                            <td ><strong>No. of Days:</strong></td>
                            <td ><input name="select" id="select" type="text" size="10"></td>
                        </tr>
                        <tr valign="top" >
                            <td ><strong>Contact Hours:</strong>*</td>
                            <td ><input name="courseLength" id="courseLength" type="text" size="10"></td>
                        </tr>
                        <tr valign="top" >
                            <td ><strong>CM Points: </strong></td>
                            <td ><input name="cmPoints" id="cmPoints" type="text" size="10"></td>
                        </tr>
                        <tr valign="top" >
                            <td ><strong>CEU Points:</strong></td>
                            <td ><input name="ceuPoints" id="ceuPoints" type="text" size="10"></td>
                        </tr>
                        <tr valign="top"  >
                            <td colspan="2" class="blackTen"></td>
                        </tr>
                        <tr valign="top" >
                            <td ><strong>Cost: </strong></td>
                            <td><input name="cost" type="text" id="cost" size="10" value=""></td>
                        </tr>
                        <tr>
                            <td valign="middle" ><strong>Language:</strong>*</td>
                            <td valign="top"><select id="select2" name="select2" class="frmFieldSearch"></select></td>
                        </tr>
                    </table>
                    <table width="100%" border="0" cellspacing="0" cellpadding="1" summary="">
                        <tr>
                            <td align="right"><input id="Submit" name="Submit" type="button" onClick="submitDocument();" value= "Submit"><input id="Reset" name="Reset" type="button" onClick="clearDocument(1);" value= "Reset"></td>
                        </tr>
                    </table>

                    <div align="right" class="blackSix"><strong>* Required field</strong></div>
                </td>
            </tr>
            <tr>
                <td colspan="2" valign="top"></td>
            </tr>
        </table>
    </div>
</div>

<div id="page2" class="subpage" style="display:none; height:600px;">
    <div align="center"><img src="banner.png" border="0" alt="OTI Education Center Course Search"></div>
    <p class="blackTen" align="center"><strong>Selection Criteria:</strong>
        Users may use any of the selection criteria below to search for OSHA
        training courses offered by the OSHA Training Institute (OTI) Education
        Centers. Please note that registration is conducted through the authorized
        OTI Education Center. </p>
    <hr size="1">
    <table width="970" border="0" cellspacing="0" cellpadding="1" summary="">
        <tr >
            <td class="blackTen" width="162"><strong>Course Title:</strong> </td>
            <td width="662"><select id="pg3Title" name="pg3Title" class="frmFieldSearch"></select></td>
            <td width="140" rowspan="3" align="right" valign="bottom">
                <input class="blackSix" name="button" type="button" onClick="courseSearch(3);" value= "Find Courses">
                <input class="blackSix" name="button" type="button" onClick="courseSearch(3);" value= "Refresh">
                <input class="blackSix"  name="button" type="button" onClick="clearDocument(3);" value= "Reset">
            </td>
        </tr>
        <tr class="blackTen">
            <td><strong>OTI Education Center:</strong></td>
            <td><select id="pg3EdCenter" name="pg3EdCenter" class="frmFieldSearch"></select></td>
        </tr>
        <tr>
            <td  class="blackTen" colspan="2"><strong>State:</strong>
                <select id="stateLov" name="stateLov" class="frmFieldSearch"></select> &nbsp;
                <strong>Start Date:</strong>
                <input id="pg3StartDate" name="pg3StartDate" type="text" size="10" value="mm/dd/yyyy">&nbsp;
                <strong>End Date:</strong> <input id="pg3EndDate" name="pg3EndDate" type="text" size="10" value="mm/dd/yyyy">&nbsp;
                <strong>No. of Days:</strong> <input id="noOfDays" name="noOfDays" type="text" size="2" value="">&nbsp;
                <strong>CM:</strong> <input type="checkbox" id="pg3cmPoints" name="pg3cmPoints" value="Y">&nbsp;
                <strong>CEU:</strong> <input type="checkbox" id="pg3ceuPoints" name="pg3ceuPoints" value="Y">
            </td>
        </tr>
    </table>

    <hr size="1">

    <div style="border: 2px solid #D9D9D9; width:980; height:275; " >
        <div id = "header" style="width:980;" align="center">
            <table width="100%" border="0"  summary="">
                <tr style="font-size:70%; font-weight:bold; background:#D9D9D9;" align="center" id = "srchTabHdr">
                    <td width="145">OTI Education Center</td>
                    <td width="175">Course Title</td>
                    <td width="70">Start Date</td>
                    <td width="70">End Date</td>
                    <td width="110">Training Location</td>
                    <td width="120">Address</td>
                    <td width="80">City</td>
                    <td width="40">State</td>
                    <td width="40">CM</td>
                    <td width="40">CEU</td>
                    <td width="40" id="edit">Edit</td>
                    <td width="50" id="delete">Delete</td>
                </tr>
            </table>
        </div>

        <div id = "pg3dgrid" style="width:980; height:250; overflow:auto;" align="center"></div>
    </div>
</div>

<div id="page3" class="subpage" style="display:none; height:400px;">
    <div align="center"><img src="banner.png" border="0" alt="OTI Education Center Course Search"></div>
    <br>
    <p class="blackTen">
    <table class="blackTwelve">
        <tr><td width="150"><strong>Extranet Email:</strong></td><td width="70"><input  id="userEmail" name="UserEmail" type="text" size="50"></td></tr>
        <tr><td width="150"><strong>OTI Education Center:</strong></td><td width="100"><select id="pg4EdCenter" name="pg4EdCenter" class="frmFieldSearch"></select></td></tr>
        <tr><td><input id="Userbutton" name="Userbutton" type="button" onClick="addUser();" value= "Add User"></td></tr>
    </table>
    </p>
</div>
</div>

</div>

</td>
</tr>
</table>

<!-- END BODY -->
<!--START SSI For Intranet Footer-->					</td>
</tr>
</table>
<br>
</div>
<div id="footer">
    <div id="footerlinks">
        <a class="red" href="http://www.labornet.dol.gov/" title="LaborNet">LaborNet</a>  |  <a class="red" href="http://www.dol.gov" title="U.S. Deparment of Labor site">DOL.gov</a>  |  <a href="http://www.osha.gov" title="OSHA Public Site">OSHA.gov</a>  |  <a href="http://intranet.osha.gov/helpdesk/index.html" title="IT Helpdesk">IT Helpdesk</a>  |  <a href="http://www.labornet.dol.gov/security/" title="Security & Emergency Management">Security & Emergency Management</a></div>
</div>
</div>
</div>
</div>
<br />

</body>
</html><!--END SSI For Intranet Footer-->

